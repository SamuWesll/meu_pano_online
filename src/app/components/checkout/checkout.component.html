<main class="container">
    <h3 class="d-flex justify-content-center">Preencha os dados para finalizar compra!</h3>
    <form #f="ngForm" (ngSubmit)="onSubmit(f)" id="checkout" class="row mt-4">
        <div class="col-md-4">
            <header class="p-2" style="background-color: rgba(31, 189, 139, 0.29); color: white;" >
                Dados pessoais
            </header>
            <div class="p-2">
                <div class="form-group">
                    <label for="nome">Nome completo*</label>
                    <input class="form-control" type="text" id="nome" name="nome"
                    placeholder="Digite seu nome completo" [ngModel]="usuario.nome" [ngModel] pattern="[a-zA-Z ]*"
                    minlength="12" maxlength="50"required #nome="ngModel"> 
                    <div *ngIf="!nome.valid && nome.touched"
                    class="alert alert-danger" role="alert">
                        Nome é obrigatório. (Somente letras)
                    </div>
                </div>
            
                <div class="form-group">
                    <label for="cpf">CPF*</label>
                    <input ng class="form-control" type="text" id="cpf" name="cpf"
                    placeholder="Digite o seu CPF" [ngModel]="usuario.cpf" 
                    [ngModel]  pattern="^\s*(?:\+?\d{1,3})?[- (]*\d{3}(?:[- )]*\d{3})?[- ]*\d{4}(?: *[x/#]\d+)?\s*$"
                    minlength="11" maxlength="11" required #cpf="ngModel">
                    <div *ngIf="!cpf.valid && cpf.touched"
                    class="alert alert-danger" role="alert">
                        CPF é obrigatório. (Somente números - 11 digitos)
                    </div>
                </div>

                <div class="form-group">
                    <label for="telefone">Telefone ou celular*</label>
                    <input class="form-control" type="tel" id="telefone" name="telefone"
                    placeholder="Digite o numero do seu telefone"  [ngModel]="usuario.telefone" 
                    [ngModel]  pattern="^\s*(?:\+?\d{1,3})?[- (]*\d{3}(?:[- )]*\d{3})?[- ]*\d{4}(?: *[x/#]\d+)?\s*$"
                    minlength="10" maxlength="11" required #telefone="ngModel">
                    <div *ngIf="!telefone.valid && telefone.touched"
                    class="alert alert-danger" role="alert">
                        É necessário um número, telefone ou celular.
                    </div>
                </div>

                <div class="form-group">
                    <label for="email">Email*</label>
                    <input class="form-control" type="email" id="email" name="email"
                    placeholder="Digite o seu email"  [ngModel]="usuario.email" required pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
                    minlength="12" maxlength="40" required email #email="ngModel">
                    
                    <div *ngIf="!email.valid && email.touched "
                    class="alert alert-danger" role="alert"  >
                        Digite um email válido.
                    </div>
                </div>

                <div class="form-group">
                    <label for="senha">Senha*</label>
                    <input class="form-control" type="password" id="senha" name="senha"
                    placeholder="Digite sua senha"  [ngModel]="usuario.senha" 
                    minlength="6" maxlength="20" required #senha="ngModel" [class.is-invalid]="senha.invalid && 
                    senha.touched || senha.touched && senha.value != confSenha.value" [class.is-valid]="senha.touched &&
                    senha.value == confSenha.value" [maxlength]="30" [minlength]="5">
                    <div *ngIf="!senha.valid && senha.touched"
                    class="alert alert-danger" role="alert">
                        Senha é obrigatório.
                    </div>
                    <!-- <div *ngIf="senha.errors.minlength">
                        A senha deve contem no minimo 5 caracteres
                    </div> -->
                </div>

                <div class="form-group">
                    <label for="confSenha">Confirme a senha*</label>
                    <input class="form-control" type="password" id="confSenha"
                    name="confSenha" placeholder="Confirme sua senha" [ngModel]="usuario.confSenha" 
                    minlength="5" maxlength="30" required #confSenha="ngModel" [class.is-invalid]="confSenha.invalid && 
                    confSenha.touched || confSenha.touched && senha.value != confSenha.value" [class.is-valid]="confSenha.touched && 
                    senha.value == confSenha.value" [maxlength]="30" [minlength]="5">
                    <div *ngIf="!confSenha.valid && confSenha.touched"
                    class="alert alert-danger" role="alert">
                        É obrigatório confirmar a senha.
                    </div>
                    
                </div>

            </div>
        </div>
        <div class="col-md-4">
            <header class="text-light p-2" style="background-color: rgba(31, 189, 139, 0.29);">
                Entrega
            </header>
            <div class="p-2">
                <div class="form-group">
                    <label for="cep">CEP</label>
                    <input class="form-control" type="text" id="cep" name="cep"
                    
                       
                    placeholder="Digite seu CEP" [ngModel]="usuario.cep"
                    minlength="8" maxlength="8" required #cep="ngModel" 
                    [ngModel]  pattern="^\s*(?:\+?\d{1,3})?[- (]*\d{3}(?:[- )]*\d{3})?[- ]*\d{4}(?: *[x/#]\d+)?\s*$"
                    (blur)="consultaCEP($event.target.value)"
                    (keydown)="consultaCEP(usuario.cep)"> 
                    <div *ngIf="!cep.valid && cep.touched"
                    class="alert alert-danger" role="alert">
                    CEP é obrigatório.
                    </div>
                </div>

                <div class="form-group">
                    <label for="endereco">Endereço*</label>
                    <input class="form-control" type="text" id="endereco" name="endereco"
                    placeholder="Digite seu endereço" [ngModel]="usuario.endereco"
                    required #endereco="ngModel">
                    <div *ngIf="!endereco.valid && endereco.touched"
                    class="alert alert-danger" role="alert">
                    Endereço é obrigatório.
                    </div>
                </div>

                <div class="form-group">
                    <label for="numero">Número*</label>
                    <input class="form-control" type="string" id="numero" name="numero"
                    placeholder="Digite o número" [ngModel]="usuario.numero" 
                    
                    minlength="2"  maxlength="5" required #numero="ngModel">
                    <div *ngIf="!numero.valid && numero.touched"
                    class="alert alert-danger" role="alert">
                    Número é obrigatório. (Somente números)
                    </div>
                </div>

                <div class="form-group">
                    <label for="complementoUsuario">Complemento</label>
                    <input class="form-control" type="text" id="complementoUsuario" name="complemento"
                        placeholder="Digite o complemento"
                        [ngModel]="usuario.complemento" #complemento="ngModel">
                </div>

                <div class="form-group">
                    <label for="bairro">Bairro*</label>
                    <input class="form-control" type="text" id="bairro" name="bairro"
                    placeholder="Digite seu bairro" [ngModel]="usuario.bairro"
                    required #bairro="ngModel">
                    <div *ngIf="!bairro.valid && bairro.touched"
                    class="alert alert-danger" role="alert">
                    Bairro é obrigatório.
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-6">
                        <label for="cidade">Cidade*</label>
                        <input class="form-control" type="text" id="cidade" name="cidade"
                        placeholder="Cidade" [ngModel]="usuario.cidade"
                        required #cidade="ngModel">
                        <div *ngIf="!cidade.valid && cidade.touched"
                        class="alert alert-danger" role="alert">
                        Digite sua cidade.
                        </div>
                    </div>
                    <div class="col-6">
                        <label for="estado" >Estado*</label>
                        <select class="form-control" name="estado" id="estado" [ngModel]="usuario.estado"
                        required #estado="ngModel">
                        <div *ngIf="!estado.valid && estado.touched"
                        class="alert alert-danger" role="alert">
                        Selecione seu estado.
                        </div>
                        
                            <option value="" disabled selected >Estado*</option>
                            <option value="AC">AC</option>
                            <option value="AL">AL</option>
                            <option value="AP">AP</option>
                            <option value="AM">AM</option>
                            <option value="BA">BA</option>
                            <option value="CE">CE</option>
                            <option value="DF">DF</option>
                            <option value="ES">ES</option>
                            <option value="GO">GO</option>
                            <option value="MA">MA</option>
                            <option value="MT">MT</option>
                            <option value="MS">MS</option>
                            <option value="MG">MG</option>
                            <option value="PA">PA</option>
                            <option value="PB">PB</option>
                            <option value="PR">PR</option>
                            <option value="PE">PE</option>
                            <option value="PI">PI</option>
                            <option value="RJ">RJ</option>
                            <option value="RN">RN</option>
                            <option value="RS">RS</option>
                            <option value="RO">RO</option>
                            <option value="RR">RR</option>
                            <option value="SC">SC</option>
                            <option value="SP">SP</option>
                            <option value="SE">SE</option>
                            <option value="TO">TO</option>
                        </select>
                    </div>
                </div>
                <div  class="p-2 row">
                    <div class="col-6" >
                        <label><input type="radio" name="frete" value="male" checked> Até 30 dias - R$ 7,99</label>
                        <label><input type="radio" name="frete" value="female" >Até 7 dias - R$ 15,99</label>
                    </div>
                </div>
                
            </div>
        </div>

        <div class="col-md-4">
            <header class=" text-light p-2" style="background-color: rgba(31, 189, 139, 0.29);">
                Pagamento
            </header>
            <div class="d-flex justify-content-center flex-column p-2">
                <h4>Pano de prato sua casa, personalizado - Julius. </h4>
                <p><b>$ 4,99</b></p>
            </div>
            <div class="p-2">
                <div class="form-group">
                    <label for="numCartao">Numero do cartão*</label>
                    <input class="form-control" type="text" id="numCartao" name="numCartao"
                    placeholder="Digite o numero do cartão" [ngModel]="usuario.numCartao" pattern="^\d{16}$"
                    minlength="16" maxlength="16" required #numCartao="ngModel">
                    <div *ngIf="!numCartao.valid && numCartao.touched"
                        class="alert alert-danger" role="alert">
                        Número do cartão é obrigatório.
                    </div>
                </div>

                <div class="form-group row">
                    <div class="col-8">
                        <label for="dtValidade">Data de validade*</label>
                        <input class="form-control" type="month" format="yyyy-mm" min="2020-03" 
                        max="2099-12" id="dtValidade" name="dtValidade"
                        placeholder="Validade" [ngModel]="usuario.dtValidade"
                        required #dtValidade="ngModel">
                        <div *ngIf="!dtValidade.valid && dtValidade.touched"
                            class="alert alert-danger" role="alert">
                            Data de validade é obrigatória.
                        </div>
                    </div>
                    <div class="col-4">
                        <label for="cdSeguranca">Cod. S*</label>
                        <input class="form-control" type="text" id="cdSeguranca" name="cdSeguranca"
                        placeholder="CVV" [ngModel]="usuario.cdSeguranca" pattern="^\d{3}$"
                        [minlength]="3" [maxlength]="3"
                        required #cdSeguranca="ngModel">
                        <div *ngIf="!cdSeguranca.valid && cdSeguranca.touched"
                            class="alert alert-danger" role="alert">
                            Cd. Seg
                        </div>
                    </div>
                </div>


                <div class="form-group">
                    <label for="nomeTitular">Nome do titular*</label>
                    <input class="form-control" type="text" id="nomeTitular" name="nomeTitular"
                    placeholder="Digite o nome do titular" [ngModel]="usuario.nomeTitular" [ngModel] pattern="[a-zA-Z ]*"
                    minlength="12" required #nomeTitular="ngModel">
                    <div *ngIf="!nomeTitular.valid && nomeTitular.touched"
                        class="alert alert-danger" role="alert">
                        Nome do titular é obrigatório.
                    </div>
                </div>

                <div class="form-group">         
                    <label for="cpfTitular">CPF do titular*</label>
                    <input class="form-control" type="text" id="cpfTitular" name="cpfTitular"
                    placeholder="Digite o CPF do titular" [ngModel]="usuario.cpfTitular" pattern="^\d{11}$"
                    minlength="11" maxlength="11" required #cpfTitular="ngModel">
                    <div *ngIf="!cpfTitular.valid && cpfTitular.touched"
                        class="alert alert-danger" role="alert">
                        CPF do titular é obrigatório.
                    </div>
                </div>

            </div>
            <div class="d-flex justify-content-end">
                <button type="submit" class="btn btn-success" data-toggle="modal" 
                data-target="#compraFinalizada" [disabled]="!f.valid" >Finalizar compra</button>
            </div>
        </div>
    </form>
</main>
<div id="compraFinalizada" class="modal" tabindex="-1" role="dialog">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Compra realizada com sucesso!</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p><b>Obrigado pela confiança! </b>Seja bem vindo.</p>
        </div>
        <div class="modal-footer">        
          <button type="button" class="btn btn-primary" data-dismiss="modal">Fechar</button>
        </div>
      </div>
    </div>
  </div>
